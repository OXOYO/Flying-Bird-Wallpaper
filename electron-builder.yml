appId: co.oxoyo.flying-bird-wallpaper
productName: Flying Bird Wallpaper
# 启用更新文件生成
generateUpdatesFilesForAllChannels: true

# 全局配置
forceCodeSigning: false
buildDependenciesFromSource: true
compression: maximum

# 打包后hooks
afterPack: ./scripts/after-pack-hook.mjs

directories:
  buildResources: build
  output: dist
files:
  - 'out/main/**/*'
  - 'out/preload/**/*'
  - 'out/renderer/**/*'
  - '!**/.vscode/*'
  - '!src/*'
  - '!electron.vite.config.{js,ts,mjs,cjs}'
  - '!{.eslintignore,.eslintrc.cjs,.prettierignore,.prettierrc.yaml,dev-app-update.yml,CHANGELOG.md,README.md}'
  - '!{.env,.env.*,.npmrc,package-lock.json}'
extraMetadata:
  main: out/main/index.js
extraResources:
  - from: out/h5
    to: resources/h5
  - from: resources
    to: resources
asarUnpack:

win:
  executableName: Flying Bird Wallpaper
  target:
    - target: nsis
      arch:
        - x64
        - arm64
  icon: build/icon.ico

# NSIS 配置
nsis:
  artifactName: 'Flying-Bird-Wallpaper-${version}-${arch}-setup.${ext}'
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
  # 允许用户更改安装目录
  allowToChangeInstallationDirectory: true
  # 安装完成后打开应用程序
  runAfterFinish: true
  differentialPackage: false

mac:
  artifactName: 'Flying-Bird-Wallpaper-${version}-${arch}.${ext}'
  entitlementsInherit: build/entitlements.mac.plist
  category: public.app-category.utilities
  darkModeSupport: true
  hardenedRuntime: true
  gatekeeperAssess: false
  icon: build/icon.icns
  identity: 'co.oxoyo.flying-bird-wallpaper'
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.
  notarize: false
  target:
    - target: dmg
      arch:
        - x64
        - arm64
dmg:
  artifactName: 'Flying-Bird-Wallpaper-${version}-${arch}.${ext}'
  icon: build/icon.icns
  window:
    width: 540
    height: 380
  writeUpdateInfo: true

# Linux 配置已禁用
# linux:
#   target:
#     - AppImage
#     - snap
#     - deb
#   maintainer: electronjs.org
#   category: Utility
# appImage:
#   artifactName: Flying-Bird-Wallpaper-${version}.${ext}
npmRebuild: true # 将 false 改为 true
publish:
  # GitHub 发布配置
  provider: github
  owner: OXOYO
  repo: Flying-Bird-Wallpaper
  private: false
  releaseType: release
  publishAutoUpdate: true
  # 添加更新通道配置
  channel: latest
  # 确保发布正确的文件
  publisherName: ['*.exe', '*.dmg', 'latest*.yml', '!*.blockmap']
  # 本地发布测试
  # provider: generic
  # url: http://localhost:8080
electronDownload:
  mirror: https://npmmirror.com/mirrors/electron/
